## XSS 攻击与防范
### XSS 攻击
跨站脚本攻击 Cross-site scripting (XSS)使得攻击者可以将恶意脚本注入到网页上，当用户正常访问页面的时候，导致恶意脚本执行。造成的危害包括：劫持用户会话，插入恶意内容，重定向用户，使用恶意软件劫持用户浏览器，修改路由器配置等。

### 分类
大致上可分为持久型和非持久型

- 持久型跨站：跨站代码存储在服务器（数据库）。
- 非持久型跨站：反射型跨站攻击。常见的形式是邮件或者钓鱼链接（指向受信任网站，但是被注入了 XSS 脚本）。

### 如何防范

- 基于特征防御：XSS 漏洞就和 SQL 注入漏洞一样，都利用了 Web 页面编写的不完善，而且每一个漏洞利用和针对的弱点都不一样，很难用单一的特征覆盖所有的 XSS 漏洞。
- 基于代码修改：用户想服务器提交的信息要进行校验，过滤掉不是规定长度，格式的内容。
- 使用 Http only 的 cookie：防止被 cookie 暴露在客户端脚本前。
- 选择性禁用脚本：Content-Security-Policy（CSP）让浏览器只运行策略（policy）信任的脚本。（现代大多用基于随机数的策略：产生一个随机数，只有受信任的脚本才能产生受信任的随机数）。
- 使用 cookie 的 SameSite 属性，可以设置为 Strict，Lax。1) Strict 最严格，完全禁止第三方 Cookie，跨站点时，任何情况都不会发送 cookie。绝对安全，但是用户体验也最不好。2)大多数时候也不发送 cookie，但是带有只读语义的请求（如 Get 请求）除外。
- 自动化工具查找：自动化工具如代码扫描工具，对代码做静态分析，找出存在 XSS 漏洞的代码。