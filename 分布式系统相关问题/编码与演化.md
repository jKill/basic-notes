## 编码与演化
### 前向兼容性
旧代码可以读取新代码产生的数据。可通过给新字段添加标签号码实现。在旧代码尝试读取新代码写入的数据时，如不能识别其标签号码，可以简单忽略该字段。

### 后向兼容性
新代码可以读取旧代码产生的数据。同样可以通过添加标签号码实现，但是添加新的字段需要注意：不能是必选字段，必须是可选或具有默认值的。因为旧代码不会写入这个字段。

### REST 和自定义 RPC 协议

- 使用二进制编码的自定义 RPC 协议可以达到比通用的基于 JSON 的 REST 更好的性能。
- 但是 RESTful API 受到主流编程语言和平台的支持，生态更好，更方便调试。

场景：

- REST 更适合用于公共 API。
- RPC 框架的中点在于同组织内部服务之间的请求，通常在同一数据中心内。

### 消息传递中的数据流
与直接 RPC 相比，消息代理（也叫消息队列或消息中间件）有以下优点：

- 收件人不可用或过载，可充当缓冲区，提高系统可靠性。
- 自动重发消息，防止消息丢失。
- 发件人不需要知道收件人的IP、端口号。
- 允许一条消息发送多个收件人。
- 发件人和收件人逻辑分离。（解耦，发件人只发布，不关心使用者，fire and forget）。

### Actor 框架
Actor 模型是单个进程中并发的编程模型。

- 逻辑封装在角色中，而不是直接处理线程（竞争、死锁等问题）。
- 角色一次只能处理一条消息，因此不需要担心线程。每个角色可以由框架独立调度。
- 异步消息，不保证送达，可能丢失消息。
- 实质上是消息代理和角色编程模型集成到一个框架中，仍需考虑向前和向后兼容问题，消息可能从新版本节点发到旧版本节点。