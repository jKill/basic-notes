## 熔断与限流是如何实现的？
### 熔断如何实现
熔断器的工作状态分为打开、半打开、关闭。正常状态下是关闭的。

- 调用方调用下游服务异常时，熔断器会收集异常信息。到达熔断条件时拦截请求，并快速执行失败逻辑。
- 经过一段时间后，熔断器尝试转为半打开状态，这时熔断器允许通过一个请求，如果这个请求成功了，熔断器转为关闭。否则恢复打开状态。

### Sentinel 熔断的降级策略

- 平均响应时间：如果1s内的平均响应时间超过阈值，那么在接下来的时间窗口内，对这个方法的调用会触发熔断/执行降级策略。
- 异常比例：1s内请求异常比例超过阈值后，熔断/执行降级策略。
- 异常数：1分钟内异常请求数超过阈值后，熔断/执行降级策略。

### 限流如何实现
可以分为两大类，客户端限流和服务端限流。客户端限流主要包括前端的防重复点击按钮、验证答题等。服务端限流有滑动窗口、令牌桶、漏桶算法等。

#### 滑动窗口
时间窗口内请求数量达到阈值，丢弃请求。
#### 漏桶算法

- 水（请求）从桶上方进入桶内，从下方以恒定速度漏出（被处理）。
- 来不及漏出的水在桶内（缓冲），水满后溢出（丢弃）。

#### 令牌桶算法

- 以恒定速度向桶内放令牌，请求到来时，从桶内拿到令牌才能被处理。
- 桶被放满后，多余的令牌会溢出。

#### 漏桶和令牌桶算法区别

- 漏桶算法：限制请求处理速度。
- 令牌桶算法：限制请求处理速度，还允许一定程度的突发流量。




