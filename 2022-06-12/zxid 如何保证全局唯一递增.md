## zxid 如何保证全局唯一递增

- zxid 高32位为 epoch，低32位为事务 id。
- ZooKeeper 所有写操作、事务都由主节点处理，单点保证事务 id 全局递增且唯一。

### 场景

- 作为分布式锁的 fencing token，防止因进程停顿导致的锁过期，而无法保证共享存储写入过程的互斥。

### 缺陷

- 单点依赖：ZK 主节点一旦挂掉，就无法继续产生 zxid。并且 zk 在主节点挂掉后，会停止服务，直到选举完成。